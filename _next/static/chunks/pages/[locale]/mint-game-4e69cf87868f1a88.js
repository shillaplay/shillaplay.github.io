(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[689],{11537:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[locale]/mint-game",function(){return t(23761)}])},75276:function(e,n,t){"use strict";var r=t(85893),o=t(68527),a=t(26723),i=t(14382),c=t(13365),s=t(82138),u=t(81961),l=t(94045),f=t(57277),m=t(67294),g=t(83897);n.Z=function(e){var n=e.resetGetter,t=e.id,d=e.submitHandler,p=e.gameStyle,y=e.gameStatus,S=(0,s.Z)("edit-game"),x=S.t,w=S.lang,v=(0,f.$x)(t),P=v.owner,b=v.entryPrice,h=v.countDownDuration,k=v.primaryWinnerPercentage,W=v.secondaryWinnerPercentage,O=v.ownerPercentage,_=v.gameInfoStatus,j=(0,m.useState)(),C=j[0],E=j[1],Z=(0,m.useState)(""),H=Z[0],B=Z[1],D=(0,m.useState)(),T=D[0],$=D[1],I=(0,m.useState)(""),N=I[0],z=I[1],G=(0,m.useState)(),M=G[0],J=G[1],A=(0,m.useState)(""),F=A[0],L=A[1],X=(0,m.useState)(),Q=X[0],R=X[1],q=(0,m.useState)(""),K=q[0],U=q[1],V=(0,m.useState)(),Y=V[0],ee=V[1],ne=(0,m.useState)(""),te=ne[0],re=ne[1],oe=function(){console.log("reset::"),E((0,l.aQ)(b,0)),$(parseInt(h)),J(parseInt(O)),R(parseInt(k)),ee(parseInt(W))};(0,m.useEffect)((function(){n&&n(oe)}),[]),(0,m.useEffect)((function(){P.toLowerCase()!=u.je&&oe()}),[P]);var ae=function(e,n){n(isNaN(e)?"":parseInt(e))},ie=!1;return _==u.J_.pending?(0,r.jsx)(o.xu,{d:"flex",justifyContent:"center",alignItems:"flex-start",children:(0,r.jsx)(c.Z,{isLoading:!0,children:""})}):(0,r.jsxs)("form",{onSubmit:function(e){try{e.preventDefault()}catch(o){}ie=!1,B(""),z(""),L(""),U(""),re(""),(0,l.N4)(C)&&(ie=!0,B(x("entry-price-empty-error"))),C<u.bB.minEntryPrice&&(ie=!0,B(x("entry-price-empty-error"))),(0,l.N4)(T)&&(ie=!0,z(x("countdown-empty-error"))),T<u.bB.gameMinCountdown&&(ie=!0,z(x("countdown-min-error",[u.bB.gameMinCountdown],!0))),T>u.bB.gameMaxCountdown&&(console.log("Form: ".concat(h,"Input | isNaN ").concat(T," = $").concat(isNaN(T)," | gt: ").concat(T>u.bB.gameMaxCountdown)),ie=!0,z(x("countdown-max-error",[u.bB.gameMaxCountdown],!0)));var n=!0,t=!0,r=!0;((0,l.N4)(M)||M<1)&&(ie=!0,n=!1,L(x("owner-empty-error"))),((0,l.N4)(Q)||M<1)&&(ie=!0,t=!1,U(x("primary-empty-error"))),((0,l.N4)(Y)||M<1)&&(ie=!0,r=!1,re(x("secondary-empty-error"))),n&&t&&r&&M+Q+Y!=100&&(console.log("Form: ".concat(M+Q+Y," != 100")),ie=!0,L(x("percentage-error")),U(x("percentage-error")),re(x("percentage-error"))),!ie&&d&&(P.toLowerCase()==u.je?d({entryPrice:C,countDownDuration:T,ownerPercentage:M,primaryWinnerPercentage:Q,secondaryWinnerPercentage:Y}):d({entryPrice:C==b?0:C,countDownDuration:T==h?0:T,ownerPercentage:M==O?0:M,primaryWinnerPercentage:Q==k?0:Q,secondaryWinnerPercentage:Y==W?0:Y}))},children:[(0,r.jsx)(i.Z,{okText:x("common:ok"),mb:4,title:"".concat(x("entry-price")),name:"entry-price",type:"number",errorMessage:H,infoText:x("info-text"),info:x("entry-price-desc"),helperText:x("entry-price-help",[g.Z.format(u.bB.minEntryPrice,{locale:w})]),value:C,onChange:function(e){return ae(e.target.value,E)}}),(0,r.jsx)(i.Z,{okText:x("common:ok"),mb:4,title:"".concat(x("countdown")),name:"countdown",type:"number",errorMessage:N,infoText:x("info-text"),info:x("countdown-desc"),helperText:x("countdown-helper-text",[g.Z.format(u.bB.gameMinCountdown,{locale:w}),g.Z.format(u.bB.gameMaxCountdown,{locale:w})]),value:T,onChange:function(e){return ae(e.target.value,$)}}),(0,r.jsx)(i.Z,{okText:x("common:ok"),mb:4,title:"".concat(x("owner-percentage")),name:"owner-percentage",type:"number",errorMessage:F,infoText:x("info-text"),info:x("owner-percentage-desc"),placeholder:15,value:M,onChange:function(e){return ae(e.target.value,J)}}),(0,r.jsx)(i.Z,{okText:x("common:ok"),mb:4,title:"".concat(x("primary-percentage")),name:"primary-percentage",type:"number",errorMessage:K,infoText:x("info-text"),info:x("primary-percentage-desc"),placeholder:65,value:Q,onChange:function(e){return ae(e.target.value,R)}}),(0,r.jsx)(i.Z,{okText:x("common:ok"),mb:4,title:"".concat(x("secondary-percentage")),name:"secondary-percentage",type:"number",errorMessage:te,infoText:x("info-text"),info:x("secondary-percentage-desc"),placeholder:20,value:Y,onChange:function(e){return ae(e.target.value,ee)}}),(0,r.jsx)(a.zx,{width:"full",type:"submit",textTransform:"capitalize",disabled:"italic"==p,fontStyle:p,children:x(y)})]})}},57277:function(e,n,t){"use strict";t.d(n,{$x:function(){return y},vk:function(){return S},qv:function(){return x}});var r=t(35666),o=t.n(r),a=t(67294),i=t(2593),c=t(16813),s=t(81961),u=t(38188),l=t(37423),f=t(94045);function m(e,n,t,r,o,a,i){try{var c=e[a](i),s=c.value}catch(u){return void t(u)}c.done?n(s):Promise.resolve(s).then(r,o)}function g(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var a=e.apply(n,t);function i(e){m(a,r,o,i,c,"next",e)}function c(e){m(a,r,o,i,c,"throw",e)}i(void 0)}))}}function d(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){d(e,n,t[n])}))}return e}var y=function(e){var n=s.J_.idle,t=s.J_.pending,r=s.J_.ok,m=s.J_.notOk,d=(0,a.useState)({owner:s.je,entryPrice:c.HW,countDownDuration:c.HW,primaryWinnerPercentage:c.HW,secondaryWinnerPercentage:c.HW,ownerPercentage:c.HW,totalSessions:c.HW,totalPlayers:c.HW,totalProfits:c.HW,bank:c.HW,gameInfoStatus:n}),y=d[0],S=d[1],x=(0,u.s5)(),w=(0,a.useState)(),v=w[0],P=w[1],b=(0,l.Z)(v,"useGameStarted");console.log("GameEvent.Started",b);var h=(0,a.useState)(),k=h[0],W=h[1],O=(0,l.Z)(k,"useGameCanceled"),_=(0,a.useState)(),j=_[0],C=_[1],E=(0,l.Z)(j,"useGameFunded"),Z=(0,a.useState)(),H=Z[0],B=Z[1],D=(0,l.Z)(H,"useGameEnded");return console.log("GameEvent.Ended",D),(0,a.useEffect)((function(){e&&(P((0,f.tz)(e)),W((0,f.ic)(e)),C((0,f.DQ)(e)),B((0,f.D_)(e)))}),[e]),(0,a.useEffect)((function(){var n=g(o().mark((function n(){var a;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,S((function(e){return p({},e,{gameSessionInfoStatus:t})})),n.next=4,x.gameInfo(e);case 4:a=n.sent,S({owner:a.owner,entryPrice:i.O$.from(a.entryPrice.toString()),countDownDuration:i.O$.from(a.countDownDuration.toString()),primaryWinnerPercentage:i.O$.from(a.primaryWinnerPercentage.toString()),secondaryWinnerPercentage:i.O$.from(a.secondaryWinnerPercentage.toString()),ownerPercentage:i.O$.from(a.ownerPercentage.toString()),totalSessions:i.O$.from(a.totalSessions.toString()),totalPlayers:i.O$.from(a.totalPlayers.toString()),totalProfits:i.O$.from(a.totalProfits.toString()),bank:i.O$.from(a.bank.toString()),gameInfoStatus:r}),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),S((function(e){return p({},e,{gameSessionInfoStatus:m})}));case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));x&&e&&n()}),[r,m,x,e,b,O,E,D]),y},S=function(e){var n=s.J_.idle,t=s.J_.pending,r=s.J_.ok,m=s.J_.notOk,d=(0,a.useState)({startBlock:c.HW,endBlock:c.HW,playBlock:c.HW,primaryWinnerPrize:c.HW,secondaryWinnerPrize:c.HW,ownerPrize:c.HW,vaultPrize:c.HW,sessionBank:c.HW,sessionTotalPlayers:c.HW,awaitingPlayers:!1,primaryWinner:s.je,secondaryWinner:s.je,gameSessionInfoStatus:n}),y=d[0],S=d[1],x=(0,u.s5)(),w=(0,a.useState)(),v=w[0],P=w[1],b=(0,l.Z)(v,"useGameStarted"),h=(0,a.useState)(),k=h[0],W=h[1],O=(0,l.Z)(k,"useGameCanceled"),_=(0,a.useState)(),j=_[0],C=_[1],E=(0,l.Z)(j,"usePlayEvent"),Z=(0,a.useState)(),H=Z[0],B=Z[1],D=(0,l.Z)(H,"useGameFunded"),T=(0,a.useState)(),$=T[0],I=T[1],N=(0,l.Z)($,"useGameEnded");return(0,a.useEffect)((function(){e&&(P((0,f.tz)(e)),W((0,f.ic)(e)),C((0,f.Nt)(e)),B((0,f.DQ)(e)),I((0,f.D_)(e)))}),[e]),(0,a.useEffect)((function(){var n=g(o().mark((function n(){var a;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,S((function(e){return p({},e,{gameSessionInfoStatus:t})})),n.next=4,x.gameSessionInfo(e);case 4:a=n.sent,S({startBlock:i.O$.from(a.startBlock.toString()),endBlock:i.O$.from(a.endBlock.toString()),playBlock:i.O$.from(a.playBlock.toString()),primaryWinnerPrize:i.O$.from(a.primaryWinnerPrize.toString()),secondaryWinnerPrize:i.O$.from(a.secondaryWinnerPrize.toString()),ownerPrize:i.O$.from(a.ownerPrize.toString()),vaultPrize:i.O$.from(a.vaultPrize.toString()),sessionBank:i.O$.from(a.bank.toString()),sessionTotalPlayers:i.O$.from(a.totalPlayers.toString()),awaitingPlayers:a.awaitingPlayers,primaryWinner:a.primaryWinner,secondaryWinner:a.secondaryWinner,gameSessionInfoStatus:r}),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),S((function(e){return p({},e,{gameSessionInfoStatus:m})}));case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));x&&e&&n()}),[r,m,x,e,b,O,E,D,N]),y},x=function(e){var n=s.J_.idle,t=(s.J_.pending,s.J_.ok),r=s.J_.notOk,m=(0,a.useState)({totalPlays:c.HW,totalPlaysStatus:n}),d=m[0],y=m[1],S=(0,u.s5)(),x=(0,a.useState)((0,f.sE)()),w=x[0],v=(x[1],(0,l.Z)(w));return(0,a.useEffect)((function(){var n=g(o().mark((function e(){var n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.currentGamePlays();case 3:n=e.sent,a=i.O$.from(n.toString()),y({totalPlays:a,totalPlaysStatus:t}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),y((function(e){return p({},e,{totalPlaysStatus:r})}));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));!S||e&&d.totalPlaysStatus==t||n()}),[t,r,S,v]),d}},23761:function(e,n,t){"use strict";t.r(n),t.d(n,{__N_SSG:function(){return k}});var r=t(35666),o=t.n(r),a=t(85893),i=t(92667),c=t(68527),s=t(82138),u=t(81961),l=t(62133),f=t(37911),m=t(4226),g=t(67294),d=t(86455),p=t.n(d),y=t(77044),S=t(57060),x=t(80109),w=t(38188),v=t(75276),P=t(90387);function b(e,n,t,r,o,a,i){try{var c=e[a](i),s=c.value}catch(u){return void t(u)}c.done?n(s):Promise.resolve(s).then(r,o)}function h(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var a=e.apply(n,t);function i(e){b(a,r,o,i,c,"next",e)}function c(e){b(a,r,o,i,c,"throw",e)}i(void 0)}))}}var k=!0;n.default=function(){var e=(0,s.Z)("mint-game"),n=e.t,t=e.lang,r=(0,i.pm)(),d=(0,P.useRouter)(),b=(0,y.Ge)().account,k=(0,S.Z)().onOpen,W=(0,w.s5)(),O=(0,g.useState)(),_=O[0],j=O[1],C=(0,g.useState)(),E=C[0],Z=C[1],H=function(){return b?E?"minting":"mint":"common:connect-wallet"},B=(0,g.useState)(H()),D=B[0],T=B[1],$=h(o().mark((function e(a){var i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("submitHandler:txStatus.2",a),e.prev=1,e.next=4,W.lastGameMintOf(b);case 4:i=e.sent,console.log("submitHandler:txStatus.3",i,i.toString()),Z(!1),p().fire({text:n("minting-ok",[i.toString()],!0),icon:"info",showCancelButton:!0,showConfirmButton:!0,cancelButtonText:n("common:cancel"),confirmButtonText:n("manage-nft")}).then((function(e){e.isConfirmed&&d.push(f.Z.localise("/game/?id=".concat(i.toString()),t))})),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(1),console.log("submitHandler:txStatus.4",e.t0),Z(!1),r({description:n("common:conn-error"),status:"error",duration:4e3,isClosable:!0});case 15:case"end":return e.stop()}}),e,null,[[1,10]])}))),I=h(o().mark((function e(t){var a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!E){e.next=2;break}return e.abrupt("return");case 2:return Z(!0),e.prev=3,console.log("submitHandler:txStatus.111",E,H()),e.next=7,W.mint(t.entryPrice,t.countDownDuration,t.ownerPercentage,t.primaryWinnerPercentage,t.secondaryWinnerPercentage);case 7:a=e.sent,j(a.hash),e.next=17;break;case 11:e.prev=11,e.t0=e.catch(3),i=e.t0.code,console.log("submitHandler:2",i,e.t0),Z(!1),i!=u.O1.META_MASK_TX_DECLINED?r({description:n("common:conn-error"),status:"error",duration:4e3,isClosable:!0}):r({description:n("common:tx-declined"),status:"error",duration:4e3,isClosable:!0});case 17:case"end":return e.stop()}}),e,null,[[3,11]])}))),N=((0,x.k)(_,$,(function(){r({description:n("minting-failed"),status:"error",duration:4e3,isClosable:!0}),Z(!1)})),(0,g.useState)()),z=N[0],G=N[1],M=(0,g.useState)(),J=M[0],A=M[1],F=function(e){b?I(e):(G(!0),A(e),k())};(0,g.useEffect)((function(){z&&b&&J&&(F(),G(!1)),T(H())}),[b]),(0,g.useEffect)((function(){T(H())}),[E]);return(0,a.jsx)(l.Z,{link:"/mint-game",title:n("title"),description:n("desc"),image:null,updatedTime:null,children:(0,a.jsx)(m.Z,{children:(0,a.jsx)(c.kC,{width:"full",align:"center",justifyContent:"center",alignItems:"center",children:(0,a.jsxs)(c.xu,{p:8,width:"550px",maxW:"100%",borderWidth:1,borderRadius:8,boxShadow:"lg",children:[(0,a.jsx)(c.xu,{textAlign:"center",children:(0,a.jsx)(c.X6,{fontSize:"18px",children:n("desc")})}),(0,a.jsx)(c.xu,{my:4,textAlign:"left",children:(0,a.jsx)(v.Z,{submitHandler:F,resetGetter:function(e){e},gameStyle:{"common:connect-wallet":"normal",mint:"normal",minting:"italic"}[D],gameStatus:D})})]})})})})}}},function(e){e.O(0,[868,827,607,612,455,921,409,680,774,888,179],(function(){return n=11537,e(e.s=n);var n}));var n=e.O();_N_E=n}]);